// Generated by CoffeeScript 1.9.1
(function() {
  var fileList, regStr, regStrSearch, regex, regexSearch;

  regStr = 'http:\/\/' + location.host + '\/(page\/[0-9]+)?';

  regex = new RegExp(regStr, 'm');

  regStrSearch = 'http:\/\/' + location.host + '\/search\/.+';

  regexSearch = new RegExp(regStrSearch, 'm');

  fileList = (function() {
    function fileList() {}

    fileList.prototype.selectControl = function() {
      if ($('#fileSelect').is(':checked')) {
        return $('.file_id').prop("checked", true);
      } else {
        return $('.file_id').prop("checked", false);
      }
    };

    fileList.prototype.hasSelectedItem = function() {
      return $("input[name='file_id[]']:checked").length > 0;
    };

    fileList.prototype.hasTagName = function() {
      return $('#tagName').val() !== '';
    };

    fileList.prototype.processReturnValue = function(data) {
      if (data === 'success') {
        return location.reload();
      } else {
        return alert(data);
      }
    };

    fileList.prototype.isOnIndexPage = function() {
      return regex.test(location.href);
    };

    fileList.prototype.isOnSearchPage = function() {
      return regexSearch.test(location.href);
    };

    return fileList;

  })();

  $(function() {
    var list;
    list = new fileList();
    $('#fileSelect').click((function(_this) {
      return function() {
        return list.selectControl();
      };
    })(this));
    $('#list-tag-form').submit((function(_this) {
      return function() {
        var url;
        url = $('#list-tag-form').attr('action');
        if (!list.hasSelectedItem()) {
          alert('请选择条目，不能空');
          return false;
        }
        if (!list.hasTagName()) {
          alert('标签不能为空，请填写');
          return false;
        }
        $.post(url, $('#list-tag-form').serialize(), function(data) {
          return list.processReturnValue(data);
        });
        return false;
      };
    })(this));
    $('#combineRevisions').click((function(_this) {
      return function() {
        var url;
        url = '/standards/combineRevisions';
        if (!list.hasSelectedItem()) {
          alert('请选择条目，不能空');
          return false;
        }
        $.post(url, $('#list-tag-form').serialize(), function(data) {
          return list.processReturnValue(data);
        });
        return false;
      };
    })(this));
    $('#downloadAttachments').click((function(_this) {
      return function() {
        var url;
        url = $('#downloadAttachments').attr('href');
        if (!list.hasSelectedItem()) {
          alert('请选择条目，不能空');
          return false;
        }
        $.post(url, $('#list-tag-form').serialize(), function(data) {
          return window.open(url);
        });
        return false;
      };
    })(this));
    return $('#deleteItems').click((function(_this) {
      return function() {
        var url;
        url = location.href + '/deleteTaggableItems';
        if (!list.hasSelectedItem()) {
          alert('请选择条目，不能空');
          return false;
        }
        if (list.isOnIndexPage() || list.isOnSearchPage()) {
          url = '/standards/deleteSelectedFiles';
        }
        $.post(url, $('#list-tag-form').serialize(), function(data) {
          return list.processReturnValue(data);
        });
        return false;
      };
    })(this));
  });

}).call(this);

//# sourceMappingURL=maniputateFileList.js.map
